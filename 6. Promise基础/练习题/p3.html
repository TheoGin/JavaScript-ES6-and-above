<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <select id="selProvince"></select>

    <script>
      // 调用该函数，会远程加载省份数据
      // 函数返回一个Promise，成功后得到省份数组，失败时会给予失败原因
      function getProvinces() {
        return fetch("https://study.duyiedu.com/api/citylist")
          .then((resp) => resp.json())
          .then((resp) => resp.data)
          .then((resp) =>
            resp.map((it) => ({ value: it.value, label: it.label }))
          );
      }

      // 利用getProvinces函数，将省份数据加载到select元素中
      const selectDom = document.getElementById("selProvince");

      getProvinces().then((provinces) => {
        // [ {value: '110000', label: '北京市'}, ... ]
        const htmlStr = provinces
          .map(
            (province) =>
              `<option value=${province.value}>${province.label}</option>`
          )
          .join("");

        selectDom.innerHTML = htmlStr;
      });

      /* let htmlStr = '';
      getProvinces().then((provinces) => {
        // [ {value: '110000', label: '北京市'}, ... ]
        provinces.forEach((province) => {
          htmlStr += `<option value=${province.value}>${province.label}</option>`
        });

        selectDom.innerHTML = htmlStr;
      }); */

      /* getProvinces().then((provinces) => {
        console.log(provinces);
        const fragment = document.createDocumentFragment();
        // [ {value: '110000', label: '北京市'}, ... ]
        provinces.forEach((province) => {
          const option = document.createElement("option");
          option.value = province.value;
          // option.label = province.label;
          option.innerText = province.label;
          fragment.appendChild(option);
        });

        selectDom.appendChild(fragment);
      }); */
    </script>
  </body>
</html>
